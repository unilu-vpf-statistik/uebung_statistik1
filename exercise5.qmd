---
title: "Übung 5 - Wahrscheinlichkeitstheorie"
subtitle: "HS 2025"
author: "Gidon Frischkorn"
format:
  html:
    css: styles.css
    include-after-body: webex.js
filters:
  - webr
---

```{r preparation}
#| include: false
library(exams)
library(exams2forms)
library(here)
library(dplyr)

exam_files <- list.files(here("questions_uebung5"), full.names = TRUE)
shuffeld_questions <- sample(exam_files)

# Laden des Datensatzes
semester_data2 <- read.csv("semester_data2.csv")
```

## Wiederholung & Vertiefung: Bayes Theorem & Wahrscheinlichkeitsverteilungen

In dieser Übung werden Üben mit den Verteilungsfunktionen der Binomialverteilung in R zu Arbeiten. Darüber hinaus sollen Sie sich noch einmal Vertieft mit einer anderen Parametrisierung des Bayes Theorems beschäftigen.

Für eine ausführliche Erklärung dieser alternativen Parametrizierung schauen Sie sich bitte das folgende YouTube Video an:

- [The medical test paradox, and redesigning Bayes' rule](https://www.youtube.com/watch?v=lG4VkPoG3ko)

Nehmen Sie sich bitte Zeit dafür dieses Video anzuschauen und die Konzepte und Erklärungen nachzuvollziehen. Die Inhalte können Teil der Prüfung sein und damit sollten Sie die entsprechenden Konzepte verstehen und anwenden können.

## Odds / Chancen & Bayes Faktoren

In diesem Abschnitt fasse ich die wichtigsten Informationen aus dem Video nochmal zusammen. In dem Video werden zwei wichtige Konzepte eingeführt:

1. Die Darstellung von Wahrscheinlichkeiten mit Hilfe von Odds, oder deutsch Chancen
2. Die Umformung der Sensitivität und Spezifität eines Tests in einen Bayes Faktor

### Odds / Chancen

Normalerweise schreiben wir eine Wahrscheinlichkeit als einen Bruch bzw. eine Zahl zwischen 0 und 1. Die Idee dabei ist, dass wir die Anzahl günstiger Ereignisse zur Gesamtzahhl an möglichen Ereignissen in Bezug setzen. Wenn, wir zum Beispiel die Wahrscheinlichkeit bei würfeln eines fairen Würfels eine 6 zu werfen beschreiben, dann ist diese $\frac{1}{6} = 0.16666 \dots$, weil ein Ergebnis der Zahl 6 enspricht, und es insgesamt 6 mögliche ergebnisse gibt.

Alternativ können wir diese Wahrscheinlichkeit jedoch auch als Odds (bzw. Chancen) schreiben. Dabei setzen wir die Anzahl günstiger Ergebnisse zur Anzahl ungünstiger Ergebnisse in Bezug $1:5$. Um Odds (Chancen) von Wahrscheinlichkeiten in der Notation abzugrenzen wird dabei Häufig ein Doppelpunkt verwendet. Die Odds $1:5$ beschreiben dabei genau so die Wahrscheinlichkeit und können auch in diese Übertragen werden in dem man die erste Zahl durch die Summe beider Zahlen teilt $\frac{1}{1 + 5}$. Allgemein können wir also schreiben:

$$
a:b = \frac{a}{a+b}
$$

Odds (Chancen) können dabei auch als eine Zahl zwischen 0 und Unendlich $\infty$ angegeben werden. Dabei entsprechen Odds = 1 einer Wahrscheinlichkeit von 50% oder $\frac{1}{2}$, Odds < 1 entsprechen Wahrscheinlichkeiten kleiner als 50%, und Odds > 1 entsprechen Wahrscheinlichkeiten grösser als 50%. Sind Odds als einzelne Zahl angegeben können Sie diese jeweils relativ zur Zahl 1 verstehen. Gegeben die Odds $O$ ergibt sich die Wahrscheinlichkeit:

$$
O = O:1 = \frac{O}{O+1}
$$

### Bayes Faktoren

Im Allgemeinen stellen Bayes Faktoren das Verhältnis von zwei Likelihoods, also bedigten Wahrscheinlichkeiten bestimmte Daten $D$ unter der Annahme eines Modells oder einer Hypothese $H$ zu Beobachten. Wenn wir also zwei solcher Likelihoods $P(D | H_1)$ und $P(D | H_2)$ zueinander in Bezug setzen erhalten wir den Bayes Faktor $BF$:

$$
BF_{12} = \frac{P(D | H_1)}{P(D | H_2)}
$$

Der Index des Bayes Faktors gibt dabei an, welche bedingte Wahrscheinlichkeit im Zähler bzw. im Nenner steht. Die erste Zahl bezieht sich auf den Index der Hypothese im Zähler, die zweite Zahl auf den Index der Hypothese im Nenner.

Im Bezug auf das Bayes Theorem ist die Berechnung des Bayes Faktors sehr hilfreich, da sie die Aktualisierungvon den Prior Beliefs, also unseres Wissens bevor wir die Daten gesehen haben, zu den Posterior Beliefs, also unserem Wissen nachdem wir die Daten gesehen haben, sehr klar und einfach darstellt. Stellen wir die Prior und Posterior Probability jeweils als Odds dar, gilt folgendes:

$$
O_{posterior} = BF \cdot O_{prior}
$$

#### Beispiel

Sie interessieren sich dafür wie ein bestimtes Symptom $S$ ihre Vermutung einer Diagnose $D$ verändert. Sie wissen, 

1. dass die Prior Odds der Diagnose $O(D)$ (z. Bsp. Depression) 0.1 sind (es liegt also eine Wahrscheinlichkeit von $\frac{0.1}{0.1+1} \approx 0.09 = 9\%$ für eine Depression vor). 
2. Für das beobachtete Symptom (z. Bsp. Antriebslosigkeit) ist bekannt das der Bayes Faktor = 5 ist. Das heisst zum Beispiel depressive Personen $D$ zeigen zu 75% Antriebslosigkeit, während nicht depressive Personen $\neg D$ nur zu 15% Antriebslosigkeit breichten: $\frac{P(S|D)}{P(S|\neg D)} = \frac{0.75}{0.15} = 5$. 

Mit diesen Informationen können wir schnell und einfach berechnen wie stark sich die Odds (Chancen) einer Diagnose auf Basis des beobachteten Symptoms verändern:

$$
O(D|S) = \frac{P(S|D)}{P(S|\neg D)} \cdot O(D) = \frac{0.75}{0.15} \cdot 0.1 = 5 \cdot 0.1 = 0.5
$$

Wenn wir diese Posterior Odds $O(D | S)$ in eine Wahrscheinlichkeit umrechnen erhalten wir: $\frac{0.5}{0.5+1} = 0.333 \dots \approx 33 \%$. Nachdem wir das Symptom beobachtet haben, haben wir nun also eine höhere Chance $33\% > 9\%$, dass eine Person die das Symptom berichtet an Depression leidet.

## Übungen

In den folgenden Übungen werden Sie wie in der letzten Übung mit dem simulierten Datensatz von fiktiven Daten eines Erstsemester-Jahrgangs von Psychologie-Studierenden arbeiten. Für diese Übung verwenden wir den gleichen Datensatz wie in Übung 3, sie können Sich den Datensatz auf ihren eigenen PC herunterladen: [semester_data2.csv](semester_data2.csv)

Alternativ können Sie hier auf der Website direkt R Code mit Hilfe der `webr` Erweiterung ausführen um die Aufgaben zu lösen. Der Datensatz enthält die Variablen: `geschlecht`, `nationalität`, `wohnort`, `alter` und `wissen_statistik`. Unten sehen sie die ersten Zeilen des simulierten Datensatzes.

```{r show_data}
head(semester_data2)
```

Wie in den bisherigen Übungen finden Sie hier über den Übungsaufgaben die `webr` Konsole, die Ihnen das Schreiben und Durchführen von R Code direkt auf der Website ermöglicht. Wenn viele Studierenden die Übungen parallel machen, dann kann es sein, dass `webr` sehr langsam wird.

Bitte löschen Sie die ersten Zeilen, die den Datensatz lokal verfügbar machen *nicht*. Wenn Sie die Zeilen doch aus versehen Löschen sollten dann können Sie auf der rechten Seite der Konsole das Symbol mit den im Kreis drehenden Pfeilen drücken, um die Konsole zurück zu setzen.

> Um den Code den Sie geschrieben haben auszuführen drücken Sie entwedern `Run Code`, damit der gesamte Code ausgeführt würde. Alternativ können Sie auch einzelne Zeilen ausführen, indem sie <kbd>CRTL</kbd>+<kbd>Enter</kbd> (Windows) oder <kbd>CMD</kbd>+<kbd>Enter</kbd> (Mac) drücken.

```{webr-r}
# Herunterladen der Daten um sie lokal verfügbar zu machen
url <- "https://unilu-vpf-statistik.github.io/uebung_statistik1/semester_data2.csv"
download.file(url, "semester_data2.csv")

# Laden des Datensatzes
semester_data2 <- read.csv("semester_data2.csv")

# Anzeigen der ersten Zeilen des Datensatzes
head(semester_data2)

# Schreiben Sie hier ihren Code um die Aufgaben zu lösen



```

> Nutzen Sie eine [Suchmaschine](https://unilu-vpf-statistik.github.io/uebung_statistik1/about.html#suchmaschinen), wenn Sie nicht wissen welche Funktionen Ihnen ein bestimmtes Ergebnis liefern. Ausserdem können Sie in R immer die [Hilfe](https://www.r-project.org/help.html) einer Funktion aufrufen, indem sie vor den Namen der Funktion ein Fragezeichen schreiben, z. Bsp `?median` oder die Hilfe-Funktion `help()` mit dem jeweligen Funktionsbefehl ausführen: `help(median)`.

```{r print_questions}
#| echo: false
#| message: false
#| results: "asis"
exams2forms(shuffeld_questions)
```

------------------------------------------------------------------------

[![](images/Logo_UniLu.png){fig-align="center" width="300"}](https://www.unilu.ch/fakultaeten/vpf/uebersicht/)
